/**
* \file    crc16_version.c
* \brief   \copybrief crc16_version.h
*
* \version 1.0.1
* \date    05-03-2021
* \author  Третьяков В.Ж.
*/

//*****************************************************************************
// Подключаемые файлы
//*****************************************************************************
#include "crc16_version.h"

//*****************************************************************************
// Объявление локальных типизированных констант
//*****************************************************************************


//*****************************************************************************
// Реализация интерфейсных функций
//*****************************************************************************

//*****************************************************************************
// Подсчет CRC
uint16_t crc16_version( uint8_t * buf, uint16_t len )
{
    uint32_t crc = 0;
    do
    {
        crc = ( crc + *buf++ * 44111 ) % 0x10000;
        crc = crc ^ ( crc / 256 );
        len--;
    } while( len );
    uint16_t mk2 = ( crc % 0x100 ) % 0x5E + 2;
    uint16_t mk1 = ( crc / 0x100 ) % 0x5E + 2;
    return (mk2 << 8) | mk1;
}

//*****************************************************************************
/**
* История изменений:
* 
* Версия 1.0.1
* Дата   05-03-2021
* Автор  Третьяков В.Ж.
* 
* Изменения:
*    Базовая версия.
*/
